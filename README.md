This is from an open-source code, and also some changes with the help of my friends
