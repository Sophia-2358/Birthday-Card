This is from an open-source code, with some changes made with the help of my friends.
